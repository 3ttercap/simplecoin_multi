{% extends "base.html" %}
{% block body %}

<script>
$(document).ready(function() {
  var last_5min = 0;
  generate_graph("{{ username }}/stats", ".awesome");
  setTimeout(function(){

    var hashrate, seconds, mhashpersec, user_shares, est_payout,
        round_reward, shares_to_solve, percentage_value;

    round_reward = {{ round_reward }};
    user_shares = {{ user_shares }};

    shares_to_solve = {{ current_difficulty }}*Math.pow(2, 16);
    percentage_value = user_shares/shares_to_solve;
    est_payout = ((percentage_value * round_reward))*.99;

    seconds = 60000;
    hashrate = Math.pow(2, 16) * window.last_5min;
    mhashpersec = (hashrate / seconds) / 1000;

    setInterval(function(){
      $('.odometer.hashrate').text(Math.round(mhashpersec*1000)/1000);
      $('.odometer.usershares').text(Math.round(user_shares));
      $('.odometer.estpayout').text(Math.round(est_payout*1000000)/1000000);
    },1000);


},1000);

});
</script>



<div class="container">
  <div class="row page-header">
    <h2>User Stats - {{ username }}</h2>
    <br>
    <div class="col-lg-4">
      <div class="panel panel-default">
        <div class="panel-body text-center">
          Round Shares: <span class="odometer usershares">0</span>
        </div>
      </div>
    </div>
    <div class="col-lg-4">
      <div class="panel panel-default">
        <div class="panel-body text-center">
          Est round payout: <span class="odometer estpayout">0</span> DOGE
        </div>
      </div>
    </div>
    <div class="col-lg-4">
      <div class="panel panel-default">
        <div class="panel-body text-center">
          5 min hashrate: <span class="odometer hashrate">0</span> MHashes/sec
        </div>
      </div>
    </div>

  </div>
  <div class="row row-header">
    <div class="col-lg-10 col-lg-offset-1">
      <p class="awesome"></p>
    </div>
  </div>
  <div class="row row-header" style="padding-top:50px;">
    <h2>Account</h2>
    <br>
    <div class="col-lg-3">
      <div class="panel panel-default">
        <div class="panel-body text-center">
          Balance: {{ balance }}
        </div>
      </div>
    </div>
    <div class="col-lg-3">
      <div class="panel panel-default">
        <div class="panel-body text-center">
          Unconfirmed balance: {{ unconfirmed_balance }}
        </div>
      </div>
    </div>
    <div class="col-lg-3">
      <div class="panel panel-default">
        <div class="panel-body text-center">
          Total earned: {{ total_earned }}
        </div>
      </div>
    </div>
    <div class="col-lg-3">
      <div class="panel panel-default">
        <div class="panel-body text-center">
          Total paid: {{ total_paid }}
        </div>
      </div>
    </div>
    <div class="col-lg-12">
      <div class="bs-example table-responsive">
        <table class="table table-striped table-hover ">
          <thead>
            <tr>
              <th>Time</th>
              <th>Shares</th>
              <th>Amount</th>
              <th>Blockheight</th>
              <th>TX id</th>
              <th>Status</th>
            </tr>
          </thead>
          <tbody>
            {% for payout in payouts %}
            <tr>
              <th>{{ payout.block.found_at | time_ago }}</th>
              <th>{{ payout.block.shares }}</th>
              <th>{{ payout.amount }}</th>
              <th>{{ payout.blockheight }}</th>
              <th>{{ payout.transaction_id }}</th>
              <th>{% if block.mature %}Confirmed{% else %}Unconfirmed{% endif %}</th>
            </tr>
            {% endfor %}

          </tbody>
        </table>
      </div>
    </div>
  </div>

{% endblock %}
